<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Category</title>
        <link rel="stylesheet" href="Style/style.common.css" />
        <link rel="stylesheet" href="Style/style.category.css" />
        <script src="Script/script.updatenav.js"></script>
        <script src="Script/script.category.js"></script>
        <script src="../../Script/script.cart.js"></script>
    </head>
    <body>
        <!-- header -->
        <header>
            <!-- navigation -->
            <nav class="nav-container">
                <button class="menu-toggle">&#9776;</button> <!-- ☰ icon -->
                <!-- logo -->
                <div class="logo">
                    Components <br /> PC
                </div>
                <!-- navigation list -->
                <ul class="nav-list">
                    <li><a href="index.html">Home</a></li>
                    <!-- drop list -->
                    <li>
                        <a href="Category.html">Category <span class="arrow">▼</span></a>
                        <ul> <!-- drop list items -->
                            <li><a href="#">Components <span class="arrow">▼</span></a>
                                <ul>
                                    <li><a href="/ASM_Web/Category/Components/case.html">Case</a></li>
                                    <li><a href="/ASM_Web/Category/Components/motherboard.html">Motherboard</a></li>
                                    <li><a href="/ASM_Web/Category/Components/cpu.html">CPU</a></li>
                                    <li><a href="/ASM_Web/Category/Components/gpu.html">GPU</a></li>
                                    <li><a href="/ASM_Web/Category/Components/ram.html">RAM</a></li>
                                    <li><a href="/ASM_Web/Category/Components/storage.html">Storage</a></li>
                                    <li><a href="/ASM_Web/Category/Components/power-supply.html">Power Supply</a></li>
                                    <li><a href="/ASM_Web/Category/Components/cooling.html">Cooling</a></li>
                                </ul>
                            </li>
                            <li><a href="#">Peripherals <span class="arrow">▼</span></a>
                                <ul>
                                    <li><a href="/ASM_Web/Category/Peripherals/keyboard.html">Keyboard</a></li>
                                    <li><a href="/ASM_Web/Category/Peripherals/mouse.html">Mouse</a></li>
                                    <li><a href="/ASM_Web/Category/Peripherals/monitor.html">Monitor</a></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li><a href="about.html">About</a></li>
                    <li><a href="contact.html">Contact</a></li>
                </ul>
                <!-- sign in and sign up buttons -->
                <div class="signin-signup">
                    <a href="signin.html" class="signin-link">Sign In</a>
                    <a href="signup.html" class="signup-link">Sign Up</a>
                </div>
            </nav>            
        </header>

        <!-- main content -->
        <main>
            <div class="category-main-layout">
                <!-- Sidebar Filter -->
                <aside class="category-sidebar">
                    <h3>Filter by Category</h3>
                    <form id="search-form" style="margin-bottom:18px;">
                        <input type="text" id="search-input" placeholder="Search product..." style="width:100%;padding:7px 12px;border-radius:6px;border:1px solid #bbb;font-size:1rem;">
                    </form>
                    <div class="filter-links">
                        <div class="filter-group">
                            <span class="filter-label">Components</span>
                            <div class="filter-options">
                                <a href="#" class="filter-link" data-type="component" data-value="case">Case</a>
                                <a href="#" class="filter-link" data-type="component" data-value="motherboard">Motherboard</a>
                                <a href="#" class="filter-link" data-type="component" data-value="cpu">CPU</a>
                                <a href="#" class="filter-link" data-type="component" data-value="ram">RAM</a>
                                <a href="#" class="filter-link" data-type="component" data-value="storage">Storage</a>
                                <a href="#" class="filter-link" data-type="component" data-value="power-supply">Power Supply</a>
                                <a href="#" class="filter-link" data-type="component" data-value="cooling">Cooling</a>
                            </div>
                        </div>
                        <div class="filter-group">
                            <span class="filter-label">Peripherals</span>
                            <div class="filter-options">
                                <a href="#" class="filter-link" data-type="peripheral" data-value="keyboard">Keyboard</a>
                                <a href="#" class="filter-link" data-type="peripheral" data-value="mouse">Mouse</a>
                                <a href="#" class="filter-link" data-type="peripheral" data-value="monitor">Monitor</a>
                            </div>
                        </div>
                    </div>
                </aside>
                <!-- Product Grid -->
                <section class="category-products">
                    <div id="category-products-content">
                        <!-- Products will be rendered here by JS -->
                    </div>
                </section>
            </div>
        </main>

        <!-- footer -->
        <footer>
            <div class="footer-container">
                <div class="footer-content">
                    <span class="footer-logo">Components <b>PC</b></span>
                    <span class="footer-copy">&copy; 2025 Components PC. All rights reserved.</span>
                    <span class="footer-social">
                        <a href="#" title="Facebook" aria-label="Facebook">Facebook</a> |
                        <a href="#" title="Instagram" aria-label="Instagram">Instagram</a> |
                        <a href="#" title="Twitter" aria-label="Twitter">Twitter</a>
                    </span>
                </div>
            </div>
        </footer>
        <script>
fetch('data/product.json')
    .then(res => res.json())
    .then(data => {
        const productsContent = document.getElementById('category-products-content');
        const filterLinks = document.querySelectorAll('.filter-link');
        const searchForm = document.getElementById('search-form');
        const searchInput = document.getElementById('search-input');

        function renderProducts(type, value) {
            let products = [];
            if (type === 'component') {
                products = data.Category.Components[value] || [];
            } else if (type === 'peripheral') {
                products = data.Category.Peripherals[value] || [];
            }
            productsContent.innerHTML = `
                <h2>${type === 'component' ? value.charAt(0).toUpperCase() + value.slice(1) : value.charAt(0).toUpperCase() + value.slice(1)} Products</h2>
                <div class="category-detail-grid">
                    ${products.map((p, idx) => `
                        <div class="card-product">
                            <img src="${p.image}" alt="${p.name}" class="category-detail-img" />
                            <h3>${p.name}</h3>
                            <p>${p.description}</p>
                            <p class="product-price">$${p.price}</p>
                            <a href="#" class="recommend-btn add-to-cart-btn" data-idx="${idx}">Add to Cart</a>
                        </div>
                    `).join('')}
                </div>
            `;
            // Add to cart event
            productsContent.querySelectorAll('.add-to-cart-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    const idx = +this.dataset.idx;
                    window.addToCart(products[idx]);
                });
            });
        }

        // Default: show all categories
        function showAllCategories() {
            productsContent.innerHTML = `
                <h2>Components</h2>
                <div class="category-grid">
                    ${Object.keys(data.Category.Components).map(key => `
                        <div class="category-card" data-type="component" data-value="${key}"><h4>${key.charAt(0).toUpperCase() + key.slice(1)}</h4></div>
                    `).join('')}
                </div>
                <h2>Peripherals</h2>
                <div class="category-grid">
                    ${Object.keys(data.Category.Peripherals).map(key => `
                        <div class="category-card" data-type="peripheral" data-value="${key}"><h4>${key.charAt(0).toUpperCase() + key.slice(1)}</h4></div>
                    `).join('')}
                </div>
            `;
        }

        showAllCategories();

        filterLinks.forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                renderProducts(this.dataset.type, this.dataset.value);
            });
        });

        productsContent.addEventListener('click', function(e) {
            const card = e.target.closest('.category-card');
            if (card) {
                renderProducts(card.dataset.type, card.dataset.value);
            }
        });

        if (searchForm && searchInput) {
            searchForm.addEventListener('submit', function(e) {
                e.preventDefault();
                const keyword = searchInput.value.trim().toLowerCase();
                let found = [];
                Object.values(data.Category.Components).forEach(arr => found = found.concat(arr.filter(p => p.name.toLowerCase().includes(keyword))));
                Object.values(data.Category.Peripherals).forEach(arr => found = found.concat(arr.filter(p => p.name.toLowerCase().includes(keyword))));
                productsContent.innerHTML = found.length
                    ? `<h2>Search Results</h2>
                        <div class="category-detail-grid">
                            ${found.map((p, idx) => `
                                <div class="card-product">
                                    <img src="${p.image}" alt="${p.name}" class="category-detail-img" />
                                    <h3>${p.name}</h3>
                                    <p>${p.description}</p>
                                    <p class="product-price">$${p.price}</p>
                                    <a href="#" class="recommend-btn add-to-cart-btn" data-idx="${idx}">Add to Cart</a>
                                </div>
                            `).join('')}
                        </div>`
                    : `<div style="padding:24px 0;color:#c00;font-weight:600;">No products found.</div>`;
                // Add to cart event for search results
                productsContent.querySelectorAll('.recommend-btn').forEach(btn => {
                    btn.addEventListener('click', function(e) {
                        e.preventDefault();
                        const idx = +this.dataset.idx;
                        window.addToCart(found[idx]);
                    });
                });
            });
        }
    });
</script>
    </body>
</html>